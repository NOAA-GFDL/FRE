#
# $Id: fre.properties,v 1.1.2.23.4.3 2013/11/01 20:38:04 fms Exp $
# ------------------------------------------------------------------------------
# FMS/FRE Project: Site Properties File - NESCC Version
# ------------------------------------------------------------------------------
# afy    Ver   1.00  Initial version                                April 12
# afy    Ver   2.00  Add FRE.scheduler.option.projectDual           April 12
# afy    Ver   2.01  Modify FRE.scheduler.dual.priority (-1)        April 12
# afy    Ver   3.00  Modify FRE.scheduler.outputStager.coreSpec     April 12
# afy    Ver   3.01  Remove FRE.output.workDir.clean                April 12
# afy    Ver   3.02  Add FRE.option.free.default                    April 12
# afy    Ver   3.03  Add FRE.mpi.runCommand.(solo.*|coupled)        April 12
# afy    Ver   3.04  Add FRE.sched*.option.make.size                April 12
# afy    Ver   3.05  Add FRE.sched*.option.run.(solo|coupled).size  April 12
# afy    Ver   3.06  Remove FRE.scheduler.option.ncores             April 12
# afy    Ver   3.07  Modify FRE.scheduler.run.coresPerJob (1 => 12) April 12
# afy    Ver   4.00  Remove FRE.scheduler.option.run.*.size         April 12
# afy    Ver   4.01  Add FRE.scheduler.option.run.<number>.size     April 12
# afy    Ver   5.00  Remove FRE.scheduler.option.projectDual        May 12
# afy    Ver   5.01  Remove FRE.scheduler.option.*.size             May 12
# afy    Ver   5.02  Add FRE.scheduler.option.size.*                May 12
# afy    Ver   5.03  Modify FRE.scheduler.outputStager.coreSpec     May 12
# afy    Ver   6.00  Add FRE.option.transfer.default                May 12
# afy    Ver   6.01  Remove FRE.scheduler.outputStager.*            May 12
# afy    Ver   6.02  Add FRE.scheduler.outputStager.save.*          May 12
# afy    Ver   6.03  Add FRE.scheduler.outputStager.transfer.*      May 12
# afy    Ver   6.04  Modify FRE.output.staging (add 'chained')      May 12
# afy    Ver   6.05  Add FRE.output.staging.chained.*.roots         May 12
# afy    Ver   7.00  Set FRE.tool.modules.use conditionally         June 12
# afy    Ver   7.01  Add FRE.scheduler.ppStarter.*                  June 12
# afy    Ver   8.00  Add FRE.tool.modules.*.remote                  June 12
# afy    Ver   9.00  Restrict condition for FRE.tool.modules.use.*  June 12
# afy    Ver  10.00  Add FRE.directory.scratch.roots                July 12
# afy    Ver  10.01  Modify FRE.directory.*.roots (use ^)           July 12
# afy    Ver  10.02  Remove branching on $USER                      July 12
# afy    Ver  11.00  Modify FRE.directory.stdoutTmp.default         July 12
# afy    Ver  12.00  Modify FRE.output.staging.*.roots              July 12
# afy    Ver  12.01  Add FRE.directory.stdoutTmp.final (1)          July 12
# afy    Ver  13.00  Remove FRE.call.trace                          July 12
# afy    Ver  13.01  Add FRE.versioncontrol.enabled                 July 12
# afy    Ver  14.00  Add FRE.mpi.runCommand.serial                  August 12
# afy    Ver  15.00  Add FRE.scheduler.outputStager.*.retries       November 12
# afy    Ver  15.01  Remove FRE.option.dual.default                 November 12
# afy    Ver  16.00  Cosmetics in comments                          November 12
# afy    Ver  17.00  Modify FRE.directory.stdout.default            December 12
# afy    Ver  18.00  Modify FRE.directory.archive.default           December 12
# afy    Ver  19.00  Modify FRE.scheduler.*.save.runtime.* (4h)     December 12
# afy    Ver  19.01  Modify FRE.scheduler.*.transfer.runtime.* (8h) December 12
# afy    Ver  20.00  Replace all the FRE.mpi.runCommand.*           February 13
# afy    Ver  20.01  Add FRE.mpi.component.* (generics)             February 13
# afy    Ver  20.02  Modify FRE.mpi.component.* (add wave)          February 13
# afy    Ver  20.03  Add FRE.scheduler.option.size.run.{10,12}      February 13
# afy    Ver  21.00  Modify FRE.*.outputStager.save.coreSpec (12)   March 13
# afy    Ver  22.00  Redesign FRE.*.ppStarter.* settings            March 13
# afy    Ver  23.00  Add FRE.mpi.*.subComponents                    April 13
# ------------------------------------------------------------------------------
# Copyright (C) NOAA Geophysical Fluid Dynamics Laboratory, 2012-2013
# Designed and written by V. Balaji, Amy Langenhorst and Aleksey Yakovlev
#

FRE.option.dual.default=0
FRE.option.free.default=1
FRE.option.transfer.default=1

FRE.gfdl.scratch=/scratch4/GFDL/gfdlscr/$USER

FRE.directory.stem.default=$(suite)

FRE.directory.root.default=$(FRE.gfdl.scratch)/$(stem)
FRE.directory.src.default=$(rootDir)/$(name)/src
FRE.directory.exec.default=$(rootDir)/$(name)/$(platform)-$(target)/exec
FRE.directory.scripts.default=$(rootDir)/$(name)/$(platform)-$(target)/scripts
FRE.directory.stdout.default=$(FRE.gfdl.scratch)/$(stem)/$(name)/$(platform)-$(target)/stdout
FRE.directory.stdoutTmp.default=$(stdoutDir)
FRE.directory.state.default=$(rootDir)/$(name)/$(platform)-$(target)/state
FRE.directory.work.default=$(FRE.gfdl.scratch)/work/$FRE_JOBID
FRE.directory.ptmp.default=$(FRE.gfdl.scratch)/ptmp
FRE.directory.stmp.default=$(FRE.gfdl.scratch)/stmp
FRE.directory.archive.default=$(FRE.gfdl.scratch)/$(stem)/$(name)/$(platform)-$(target)
FRE.directory.postProcess.default=$(archiveDir)/pp
FRE.directory.analysis.default=$(archiveDir)/analysis

FRE.directory.stdoutTmp.final=1

FRE.directory.scratch.roots=/scratch1;/scratch2;/scratch3;/scratch4

FRE.directory.root.roots=$HOME;$(FRE.directory.scratch.roots)
FRE.directory.src.roots=$HOME;$(FRE.directory.scratch.roots)
FRE.directory.exec.roots=$HOME;$(FRE.directory.scratch.roots)
FRE.directory.scripts.roots=$HOME;$(FRE.directory.scratch.roots)
FRE.directory.stdout.roots=$HOME;$(FRE.directory.scratch.roots)
FRE.directory.stdoutTmp.roots=$(FRE.directory.stdout.roots)
FRE.directory.state.roots=$HOME;$(FRE.directory.scratch.roots)
FRE.directory.work.roots=$(FRE.directory.scratch.roots)
FRE.directory.ptmp.roots=$(FRE.directory.scratch.roots)
FRE.directory.stmp.roots=$(FRE.directory.scratch.roots)
FRE.directory.archive.roots=$(FRE.directory.scratch.roots)
FRE.directory.postProcess.roots=$(FRE.directory.scratch.roots)
FRE.directory.analysis.roots=$(FRE.directory.scratch.roots)

FRE.directory.expNamed=archive;postProcess;analysis

FRE.mpi.component.enabled=1;1;0
FRE.mpi.component.names=atmos;ocean;wave
FRE.mpi.component.serials=atmos<ocean;atmos<wave
FRE.mpi.component.suffixes=a;o;w

FRE.mpi.atmos.subComponents=ice;land
FRE.mpi.ocean.subComponents=
FRE.mpi.wave.subComponents=

FRE.mpi.runCommand.launcher=/usr/bin/time -p '`which mpiexec.hydra`'
FRE.mpi.runCommand.option.mpiprocs=-n $
FRE.mpi.runCommand.option.nthreads=-env I_MPI_PIN_PROCESSOR_LIST allcores:grain=1,shift=$
FRE.mpi.runCommand.executable=./$executable:t

FRE.tool.modules.home=/apps/lmod/5.8

FRE.tool.modules.use=/home/fms/local/modulefiles
FRE.tool.modules.use.remote=/home/fms/local/modulefiles
FRE.tool.modules.version.remote=bronx-10

FRE.tool.archiver.extension=tar

FRE.tool.mkmf.template.mapping=intel.mk{{^\s*module\s+load\s+fre-system\/intel}};intel.mk{{^\s*module\s+load\s+intel}};NULL
FRE.tool.mkmf.template.default=intel.mk

FRE.tool.make.override.netcdf.mapping=4{{^\s*module\s+load\s+netcdf\.4\.1\.3}};3
FRE.tool.make.jobs.default=8

FRE.tool.fremake.enabled=1
FRE.tool.frerun.enabled=1
FRE.tool.frepriority.enabled=1

FRE.scheduler.enabled=1
FRE.scheduler.prefix=#PBS
FRE.scheduler.jobId.length=6

FRE.scheduler.submit.command=qsub
FRE.scheduler.submit.output.pattern=^(\d+)\.bqs1\.zeus\.fairmont\.rdhpcs\.noaa\.gov$

FRE.scheduler.option.dependsOn=-W depend=afterok:$
FRE.scheduler.option.join=-j oe
FRE.scheduler.option.mail=-m $
FRE.scheduler.option.name=-N $
FRE.scheduler.option.priority=-p $
FRE.scheduler.option.project=-A $
FRE.scheduler.option.queue=-q $
FRE.scheduler.option.rerun=-r y
FRE.scheduler.option.shell=-S /bin/tcsh
FRE.scheduler.option.size.inputStager=-l nodes=1:ppn=$
FRE.scheduler.option.size.make=-l nodes=1:ppn=$
FRE.scheduler.option.size.run.distributed=1
FRE.scheduler.option.size.run.2=-l nodes=$:ppn=$
FRE.scheduler.option.size.run.4=-l nodes=$:ppn=$+$:ppn=$
FRE.scheduler.option.size.run.6=-l nodes=$:ppn=$+$:ppn=$+$:ppn=$
FRE.scheduler.option.size.run.8=-l nodes=$:ppn=$+$:ppn=$+$:ppn=$+$:ppn=$
FRE.scheduler.option.size.run.10=-l nodes=$:ppn=$+$:ppn=$+$:ppn=$+$:ppn=$+$:ppn=$
FRE.scheduler.option.size.run.12=-l nodes=$:ppn=$+$:ppn=$+$:ppn=$+$:ppn=$+$:ppn=$+$:ppn=$
FRE.scheduler.option.startTime=-a $
FRE.scheduler.option.stdout=-o $/
FRE.scheduler.option.stdoutUmask=-W umask=$
FRE.scheduler.option.time=-l walltime=$
FRE.scheduler.option.workDir=-d $

FRE.scheduler.variable.environment=PBS_ENVIRONMENT
FRE.scheduler.variable.environment.value.batch=PBS_BATCH
FRE.scheduler.variable.jobID=PBS_JOBID

FRE.scheduler.queues=batch;urgent;debug;novel;service;bigmem

FRE.scheduler.outputStager.save.queue=batch
FRE.scheduler.outputStager.save.coreSpec=nodes=1:ppn=24
FRE.scheduler.outputStager.save.runtime.ascii=4:00:00
FRE.scheduler.outputStager.save.runtime.restart=4:00:00
FRE.scheduler.outputStager.save.runtime.history=4:00:00
FRE.scheduler.outputStager.save.retries=4

FRE.scheduler.outputStager.transfer.queue=service
FRE.scheduler.outputStager.transfer.coreSpec=size=1,vmem=10gb
FRE.scheduler.outputStager.transfer.runtime.ascii=8:00:00
FRE.scheduler.outputStager.transfer.runtime.restart=8:00:00
FRE.scheduler.outputStager.transfer.runtime.history=8:00:00
FRE.scheduler.outputStager.transfer.retries=4

FRE.scheduler.workDirCleaner.queue=service
FRE.scheduler.workDirCleaner.coreSpec=size=1
FRE.scheduler.workDirCleaner.runtime=8:00

FRE.scheduler.ppStarter.coreSpec=size=1
FRE.scheduler.ppStarter.combineOff.largeOff.queue=batch
FRE.scheduler.ppStarter.combineOff.largeOff.runtime=12:00:00
FRE.scheduler.ppStarter.combineOff.largeOn.queue=bigvftmp
FRE.scheduler.ppStarter.combineOff.largeOn.runtime=16:00:00
FRE.scheduler.ppStarter.combineOn.largeOff.queue=stage
FRE.scheduler.ppStarter.combineOn.largeOff.runtime=1:00:00
FRE.scheduler.ppStarter.combineOn.largeOn.queue=stage
FRE.scheduler.ppStarter.combineOn.largeOn.runtime=1:00:00
FRE.scheduler.ppStarter.historySize.threshold=8192

FRE.scheduler.make.coresPerJob.inc=1
FRE.scheduler.make.coresPerJob.max=100000
FRE.scheduler.run.coresPerJob.inc=24
FRE.scheduler.run.coresPerJob.max=100000

FRE.scheduler.runtime.max=8:00:00

FRE.scheduler.dual.delay=3600
FRE.scheduler.dual.priority=-1

FRE.versioncontrol.enabled=1
FRE.versioncontrol.cvs.root=:ext:cvs.princeton.rdhpcs.noaa.gov:/home/fms/cvs

FRE.autoRTS.root.prefix=/home/$USER/autoRTS
FRE.autoRTS.archive.prefix=$(FRE.gfdl.scratch)/$USER/autoRTS

FRE.output.staging=chained;staged;online

FRE.output.staging.staged.transferOn.archive.roots=$(FRE.directory.scratch.roots)
FRE.output.staging.chained.transferOn.archive.roots=$(FRE.directory.scratch.roots)
FRE.output.staging.online.transferOn.archive.roots=$(FRE.directory.scratch.roots)

FRE.output.staging.staged.transferOff.archive.roots=$(FRE.directory.scratch.roots)
FRE.output.staging.chained.transferOff.archive.roots=$(FRE.directory.scratch.roots)
FRE.output.staging.online.transferOff.archive.roots=$(FRE.directory.scratch.roots)
